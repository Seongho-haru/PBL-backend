# 🧪 PBL Backend API 테스트 가이드

## 📋 개요

이 가이드는 **강의/커리큘럼 모듈의 모든 API**를 체계적으로 테스트하기 위한 Postman Collection 사용법을 설명합니다.

---

## 🚀 시작하기

### 1. Postman Collection 가져오기

1. Postman 실행
2. **Import** 버튼 클릭
3. `PBL_API_Test_Collection.postman_collection.json` 파일 선택
4. **Import** 완료

### 2. 환경 설정 확인

- **Base URL**: `http://localhost:2358` (자동 설정됨)
- 애플리케이션이 실행 중인지 확인

---

## 📊 테스트 구조

### 🎓 **Lecture API Tests** (11개 테스트)

1. **마크다운 강의 생성** - React 기초 강의
2. **문제 강의 생성** - 두 수의 합 문제
3. **알고리즘 강의 생성** - 정렬 알고리즘 문제
4. **모든 강의 조회** - 생성된 강의들 확인
5. **강의 상세 조회** - 특정 강의 상세 정보
6. **강의 수정** - 제목 수정 테스트
7. **강의 검색** - 제목으로 검색
8. **강의 공개** - 강의를 공개 상태로 변경
9. **공개 강의 조회** - 공개된 강의만 조회
10. **테스트케이스 추가** - 문제 강의에 테스트케이스 추가
11. **강의 통계 조회** - 타입별, 카테고리별 통계

### 📚 **Curriculum API Tests** (14개 테스트)

1. **커리큘럼 생성** - 웹 개발 마스터 과정
2. **강의 추가 (첫 번째)** - React 강의 추가
3. **강의 추가 (두 번째)** - 수학 문제 추가
4. **강의 추가 (세 번째)** - 알고리즘 문제 추가 (선택)
5. **커리큘럼 상세 조회** - 3개 강의 포함 확인
6. **🔥 강의 순서 변경** - **핵심 테스트!** (3→1→2 순서로)
7. **순서 변경 확인** - 순서가 올바르게 변경되었는지 검증
8. **모든 커리큘럼 조회** - 커리큘럼 목록 확인
9. **커리큘럼 공개** - 커리큘럼을 공개 상태로 변경
10. **공개 커리큘럼 조회** - 공개된 커리큘럼만 조회
11. **공개 강의 조회 (커리큘럼용)** - 커리큘럼에 추가할 수 있는 공개 강의
12. **공개 강의 검색 (커리큘럼용)** - 조건별 공개 강의 검색
13. **강의 제거** - 커리큘럼에서 강의 제거
14. **제거 확인** - 강의가 올바르게 제거되었는지 확인

### 🧹 **Cleanup Tests** (2개 테스트)

1. **강의 삭제** - 테스트 데이터 정리
2. **커리큘럼 삭제** - 테스트 데이터 정리

---

## 🎯 핵심 테스트 포인트

### 🔥 **순서 변경 API (가장 중요!)**

- **테스트 #6**: 강의 순서 변경
- **테스트 #7**: 순서 변경 확인
- **검증 항목**:
  - ✅ API 응답 성공 (200)
  - ✅ 성공 메시지 반환
  - ✅ `orderIndex` 올바르게 변경 (1, 2, 3)
  - ✅ 강의 순서가 요청한 대로 변경됨

### 📊 **자동 검증 기능**

모든 테스트에는 **자동 검증 스크립트**가 포함되어 있습니다:

- **상태 코드 검증** (200, 404 등)
- **응답 데이터 구조 검증**
- **비즈니스 로직 검증** (순서 변경, 카운트 등)
- **변수 자동 저장** (생성된 ID들)

---

## 🔧 실행 방법

### 방법 1: 개별 테스트 실행

1. 원하는 테스트 선택
2. **Send** 버튼 클릭
3. **Test Results** 탭에서 결과 확인

### 방법 2: 전체 컬렉션 실행 (권장)

1. 컬렉션 우클릭 → **Run collection**
2. **Run PBL Backend API Test Collection** 클릭
3. 모든 테스트 자동 실행 및 결과 확인

### 방법 3: 폴더별 실행

- **Lecture API Tests**만 실행
- **Curriculum API Tests**만 실행
- **Cleanup Tests**만 실행

---

## 📈 예상 결과

### ✅ **성공 시나리오**

```
📊 Test Results Summary
✅ 27/27 tests passed
✅ All assertions passed
⏱️ Total time: ~30-60 seconds
```

### ❌ **실패 시 확인사항**

1. **애플리케이션 실행 상태** 확인
2. **포트 번호** 확인 (2358)
3. **데이터베이스 연결** 상태 확인
4. **이전 테스트 데이터** 정리 필요 여부

---

## 🔍 주요 검증 항목

### **Lecture API**

- ✅ CRUD 기본 기능
- ✅ 검색 기능 (제목, 카테고리, 타입)
- ✅ 공개/비공개 전환
- ✅ 테스트케이스 관리
- ✅ 통계 조회

### **Curriculum API**

- ✅ CRUD 기본 기능
- ✅ 강의 추가/제거
- ✅ **순서 변경** (핵심!)
- ✅ 공개/비공개 전환
- ✅ 공개 강의 검색 및 링크

### **데이터 무결성**

- ✅ 순서 인덱스 자동 관리
- ✅ 필수/선택 강의 구분
- ✅ 강의 카운트 정확성
- ✅ CASCADE 삭제 동작

---

## 💡 팁

### **변수 활용**

- `{{lectureId1}}`, `{{lectureId2}}`, `{{lectureId3}}`: 생성된 강의 ID
- `{{curriculumId}}`: 생성된 커리큘럼 ID
- `{{baseUrl}}`: 서버 주소

### **순서대로 실행**

테스트들이 서로 의존성을 가지므로 **순서대로 실행**해야 합니다.

### **데이터 정리**

테스트 완료 후 **Cleanup Tests**를 실행하여 테스트 데이터를 정리하세요.

---

## 🎉 완료!

이 테스트 컬렉션으로 **강의/커리큘럼 모듈의 모든 기능**을 체계적으로 검증할 수 있습니다!

특히 **순서 변경 API**가 정상적으로 작동하는지 확인할 수 있습니다. 🚀
